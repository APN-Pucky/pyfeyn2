{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "dd3c9519",
   "metadata": {},
   "source": [
    "# QGraf"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "b35a693f",
   "metadata": {},
   "outputs": [],
   "source": [
    "from smpl import io"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "8fdd58fc",
   "metadata": {},
   "outputs": [],
   "source": [
    "from pyfeyn2.interface import qgraf\n",
    "import itertools as it\n",
    "import re"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "1c37732f",
   "metadata": {},
   "outputs": [],
   "source": [
    "style = \"tmp.sty\"\n",
    "model =\"tmp.model\"\n",
    "dat  = \"tmp.dat\"\n",
    "output = \"output.out\"\n",
    "\n",
    "def multiple_replace(string, rep_dict):\n",
    "    pattern = re.compile(\"|\".join([re.escape(k) for k in sorted(rep_dict,key=len,reverse=True)]), flags=re.DOTALL)\n",
    "    return pattern.sub(lambda x: rep_dict[x.group(0)], string)\n",
    "\n",
    "\n",
    "\n",
    "raw_model = r\"\"\"\n",
    "* https://porthos.tecnico.ulisboa.pt/CTQFT/node9.html\n",
    "\n",
    "\n",
    "*                  Higgs\n",
    "\n",
    "*  [H,H,+]\n",
    "\n",
    "*   leptons\n",
    "\n",
    "  [e,E,-]\n",
    "\n",
    "*                  neutrinos\n",
    "\n",
    "  [n,N,-]\n",
    "\n",
    "*              quarks\n",
    "\n",
    "* [u,U,-]\n",
    "* [d,D,-]\n",
    "\n",
    "\n",
    "*      photon, W-boson, Z-boson, gluon\n",
    "\n",
    "  [A,A,+]\n",
    "  [WM,WP,+]\n",
    "  [Z,Z,+]\n",
    "* [g,g,+]\n",
    "\n",
    "*                 cubic vertices\n",
    "\n",
    "\n",
    "  [WP,WM,A]\n",
    "  [WP,WM,Z]\n",
    "* [g,g,g]\n",
    "\n",
    "\n",
    "*  [WP,WM,H]\n",
    "*  [Z,Z,H]\n",
    "*  [H,H,H]\n",
    "\n",
    "* yukawa\n",
    "\n",
    "*  [E1,e1,H]\n",
    "*  [E2,e2,H]\n",
    "*  [E3,e3,H]\n",
    "\n",
    "* [U,u,H]\n",
    "* [D,d,H]\n",
    "\n",
    "* fermion - gauge boson\n",
    "\n",
    "  [E,e,A]\n",
    "\n",
    "  [E,e,Z]\n",
    "\n",
    "  [N,n,Z]\n",
    "\n",
    "  [N,e,WP]\n",
    "\n",
    "  [E,n,WM]\n",
    "\n",
    "* [U,u,A]\n",
    "* [D,d,A]\n",
    "\n",
    "* [U,u,Z]\n",
    "* [D,d,Z]\n",
    "\n",
    "\n",
    "* [U,u,g]\n",
    "* [D,d,g]\n",
    "\n",
    "* K-M\n",
    "\n",
    "* [U,d,WP]\n",
    "\n",
    "* [D,u,WM]\n",
    "\n",
    "\n",
    "*                     quartic vertices\n",
    "\n",
    "  [WP,WM,A,A]\n",
    "*  [WP,WM,Z,Z]\n",
    "*  [WP,WM,A,Z]\n",
    "*  [WP,WM,WP,WM]\n",
    "* [g,g,g,g]\n",
    "\n",
    "*  [WP,WM,H,H]\n",
    "*  [Z,Z,H,H]\n",
    "*  [H,H,H,H]\n",
    "\n",
    "\"\"\"\n",
    "\n",
    "raw_model = multiple_replace(raw_model,{\"e\":\"e_minus\",\"E\":\"e_plus\",'n':'nu_e','N':'nu_e_bar',\"g\":\"g\",\n",
    "            \"H\":\"H_0\", 'Z':'Z_0',\n",
    "            \"WP\":\"W_plus\",\"WM\": \"W_minus\", \n",
    "            \"A\":\"gamma\"\n",
    "           })\n",
    "\n",
    "io.write(model,raw_model,\n",
    "         create_dir=False)\n",
    "io.write(style,\n",
    "         qgraf.get_style(),\n",
    "         create_dir=False)\n",
    "io.write(dat,\n",
    "          f\"\"\"\n",
    " output= '{output}' ;\n",
    " style= '{style}' ;\n",
    " model = '{model}';\n",
    " in= nu_e[p1];\n",
    " out= nu_e[p1];\n",
    " loops= 3;\n",
    " loop_momentum= l;\n",
    " options= notadpole, onshell;\n",
    " \"\"\"\n",
    "         ,create_dir=False)\n",
    "io.remove(output)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "23fe988d",
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      " --------------------------------------------------------------\n",
      "                           qgraf-3.5.2\n",
      " --------------------------------------------------------------\n",
      "\n",
      "  output= 'output.out' ;\n",
      "  style= 'tmp.sty' ;\n",
      "  model = 'tmp.model';\n",
      "  in= nu_e[p1];\n",
      "  out= nu_e[p1];\n",
      "  loops= 3;\n",
      "  loop_momentum= l;\n",
      "  options= notadpole, onshell;\n",
      "\n",
      " --------------------------------------------------------------\n",
      "\n",
      "    v-degrees          #diagrams\n",
      "\n",
      "     -   4^3     ....     0\n",
      "    3^2  4^2     ....     3\n",
      "    3^4  4^1     ....     36\n",
      "    3^6   -      ....     365\n",
      "\n",
      "\n",
      "       total =  404 connected diagrams\n",
      "\n",
      "single photon diags 99\n"
     ]
    },
    {
     "data": {
      "image/png": "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cn0rlrYFwNEETRONkAKHXF6Df17VCN2+f8Mexr44+QoVR+XyGo6fBiaTpsAhIxp2WSQ6WqrIhVhGOWQa2but5V4zOOKkwCGXsqDpD4r+gJYwkVLnqFyIbT8NG/1w4xZo6Fh99t4yHQocciG26E9I+fT9HB7IydSGHg8FDrkQ81THhAJNA4uJdlXkQsJRm7CWq0waEwUOuRA77tb5Uk3oMdGuipyZZVR4oDl8vpc5/LlOuZdrUOCQc1uzOfr+E6cjpuOiwCHnlh1/PkporbZHGhptysZBNQ45txXV8R8U7sJ37nE8WD72A5DPaTtWzswcD6/mbxzz0QX+uDPuZQzKOOTMQsf9V3KOgc5aiYICh5xfM5yhcjQrcYd0m8rYVByVs7KMivxrBy1ZRoXOW4mCMg45I6vY0oTv4WvDiEvtqcRCgUPOxjIKfjthqVFTmG60j4ICh5yPozslYwg1d6xtMfbDkM8pcMjZhIbW1qeMAww1v+EUOqZPgUPOKNzS8PDecsMWFuyneTD33i1woQu3lGM/DvmMAoecVbjnhuVb/2IldTC+UwJFePdeWKt0ztv0aTtWzq3j7cVKExoIndWWvXdLm+VUdF/bzJVrUsu5nJltWYUPZ2vYgvu3iqi2JONet9fHQBmHnJVVdOHTkTzv7L0U4dvY1y+HUY1Dzqvkk1kclr1bw9gcOTVMRqPAIdeWvx84UOCIhJYqcl73PFh/f2vL3ZtLkuy9W+5DbUskCso45KzCKnwPP8IPbuCdfoxfgont76Vt7Yv31cp1KeOQiwidbXhzlle4f/lnqyitJaPF0X51AJBclwKHjK3gt9CBZafd6SLXpKWKXJg5W1iw7bO/yWzxbEni+nARWoWNeChwyKU0FJZbxQNdMJrdrWuWsQW2VgJYrgbzGKlzVC7GCgravkvUHA/DkuSB+7Axx5qOOxbUGhYYHwUOuRKr8OHGlnS7KeZWUtBopnmMFDjkamxBwUaBIgUKHCJyNBVHReRoChwicjQFDhE5mgKHiBxNgUNEjqbAISJHU+AQkaMpcIjI0RQ4RORoChwicjQFDhE52v8Hnl0SJiHl5c8AAAAldEVYdGRhdGU6Y3JlYXRlADIwMjItMTItMTZUMTY6MDU6MzErMDA6MDAUE8naAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIyLTEyLTE2VDE2OjA1OjMxKzAwOjAwZU5xZgAAACh0RVh0ZGF0ZTp0aW1lc3RhbXAAMjAyMi0xMi0xNlQxNjowNTozMSswMDowMDJbULkAAAAtdEVYdGljYzpjb3B5cmlnaHQAQ29weXJpZ2h0IEFydGlmZXggU29mdHdhcmUgMjAxMQi6xbQAAAAxdEVYdGljYzpkZXNjcmlwdGlvbgBBcnRpZmV4IFNvZnR3YXJlIHNSR0IgSUNDIFByb2ZpbGUTDAGGAAAAE3RFWHRwZGY6VmVyc2lvbgBQREYtMS41UzZawQAAAEp0RVh0c2lnbmF0dXJlAGM4NzIwY2E1ZTViM2EzODM0NmJkMmJhNGQwMzVhMjc4Nzc2MGYwN2VkZTBiYjBhMWExNWFjMmY1Nzc4ODU0OTEBj22TAAAAAElFTkSuQmCC\n",
      "text/plain": [
       "<wand.image.Image: c8720ca 'PDF' (540x323)>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "ename": "KeyboardInterrupt",
     "evalue": "",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)",
      "Cell \u001b[0;32mIn[4], line 48\u001b[0m\n\u001b[1;32m     46\u001b[0m t \u001b[38;5;241m=\u001b[39m TikzFeynmanRender(d)\n\u001b[1;32m     47\u001b[0m \u001b[38;5;66;03m#print(t.get_src())\u001b[39;00m\n\u001b[0;32m---> 48\u001b[0m \u001b[43mt\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mrender\u001b[49m\u001b[43m(\u001b[49m\u001b[43mshow\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;28;43;01mTrue\u001b[39;49;00m\u001b[43m)\u001b[49m\n\u001b[1;32m     49\u001b[0m \u001b[38;5;66;03m#break\u001b[39;00m\n",
      "File \u001b[0;32m~/data/de.neuwirthinformatik.Alexander/Development/git/pyfeyn2/pyfeyn2/render/latex/latex.py:55\u001b[0m, in \u001b[0;36mLatexRender.render\u001b[0;34m(self, file, show, resolution, width, height, clean_up)\u001b[0m\n\u001b[1;32m     53\u001b[0m     file \u001b[38;5;241m=\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mtmp\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[1;32m     54\u001b[0m file \u001b[38;5;241m=\u001b[39m re\u001b[38;5;241m.\u001b[39msub(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m\\\u001b[39m\u001b[38;5;124m.pdf$\u001b[39m\u001b[38;5;124m\"\u001b[39m, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m\"\u001b[39m, file\u001b[38;5;241m.\u001b[39mstrip())\n\u001b[0;32m---> 55\u001b[0m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mgenerate_pdf\u001b[49m\u001b[43m(\u001b[49m\n\u001b[1;32m     56\u001b[0m \u001b[43m    \u001b[49m\u001b[43mfile\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m     57\u001b[0m \u001b[43m    \u001b[49m\u001b[43mclean_tex\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mclean_up\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m     58\u001b[0m \u001b[43m    \u001b[49m\u001b[43mcompiler\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mlualatex\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\n\u001b[1;32m     59\u001b[0m \u001b[43m    \u001b[49m\u001b[43mcompiler_args\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43m[\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43m-shell-escape\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m]\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m     60\u001b[0m \u001b[43m\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m     61\u001b[0m wi \u001b[38;5;241m=\u001b[39m WImage(\n\u001b[1;32m     62\u001b[0m     filename\u001b[38;5;241m=\u001b[39mfile \u001b[38;5;241m+\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m.pdf\u001b[39m\u001b[38;5;124m\"\u001b[39m, resolution\u001b[38;5;241m=\u001b[39mresolution, width\u001b[38;5;241m=\u001b[39mwidth, height\u001b[38;5;241m=\u001b[39mheight\n\u001b[1;32m     63\u001b[0m )\n\u001b[1;32m     64\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m delete:\n",
      "File \u001b[0;32m~/.cache/pypoetry/virtualenvs/pyfeyn2-CEvJ4jFG-py3.9/lib/python3.9/site-packages/pylatex/document.py:250\u001b[0m, in \u001b[0;36mDocument.generate_pdf\u001b[0;34m(self, filepath, clean, clean_tex, compiler, compiler_args, silent)\u001b[0m\n\u001b[1;32m    247\u001b[0m command \u001b[38;5;241m=\u001b[39m [compiler] \u001b[38;5;241m+\u001b[39m arguments \u001b[38;5;241m+\u001b[39m compiler_args \u001b[38;5;241m+\u001b[39m main_arguments\n\u001b[1;32m    249\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[0;32m--> 250\u001b[0m     output \u001b[38;5;241m=\u001b[39m \u001b[43msubprocess\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcheck_output\u001b[49m\u001b[43m(\u001b[49m\u001b[43mcommand\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m    251\u001b[0m \u001b[43m                                     \u001b[49m\u001b[43mstderr\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43msubprocess\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mSTDOUT\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m    252\u001b[0m \u001b[43m                                     \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mcheck_output_kwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    253\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m (\u001b[38;5;167;01mOSError\u001b[39;00m, \u001b[38;5;167;01mIOError\u001b[39;00m) \u001b[38;5;28;01mas\u001b[39;00m e:\n\u001b[1;32m    254\u001b[0m     \u001b[38;5;66;03m# Use FileNotFoundError when python 2 is dropped\u001b[39;00m\n\u001b[1;32m    255\u001b[0m     os_error \u001b[38;5;241m=\u001b[39m e\n",
      "File \u001b[0;32m/usr/lib/python3.9/subprocess.py:424\u001b[0m, in \u001b[0;36mcheck_output\u001b[0;34m(timeout, *popenargs, **kwargs)\u001b[0m\n\u001b[1;32m    421\u001b[0m         empty \u001b[38;5;241m=\u001b[39m \u001b[38;5;124mb\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m'\u001b[39m\n\u001b[1;32m    422\u001b[0m     kwargs[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124minput\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m empty\n\u001b[0;32m--> 424\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mrun\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mpopenargs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mstdout\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mPIPE\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mtimeout\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mtimeout\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mcheck\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;28;43;01mTrue\u001b[39;49;00m\u001b[43m,\u001b[49m\n\u001b[1;32m    425\u001b[0m \u001b[43m           \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\u001b[38;5;241m.\u001b[39mstdout\n",
      "File \u001b[0;32m/usr/lib/python3.9/subprocess.py:507\u001b[0m, in \u001b[0;36mrun\u001b[0;34m(input, capture_output, timeout, check, *popenargs, **kwargs)\u001b[0m\n\u001b[1;32m    505\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m Popen(\u001b[38;5;241m*\u001b[39mpopenargs, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mkwargs) \u001b[38;5;28;01mas\u001b[39;00m process:\n\u001b[1;32m    506\u001b[0m     \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[0;32m--> 507\u001b[0m         stdout, stderr \u001b[38;5;241m=\u001b[39m \u001b[43mprocess\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcommunicate\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;28;43minput\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mtimeout\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mtimeout\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    508\u001b[0m     \u001b[38;5;28;01mexcept\u001b[39;00m TimeoutExpired \u001b[38;5;28;01mas\u001b[39;00m exc:\n\u001b[1;32m    509\u001b[0m         process\u001b[38;5;241m.\u001b[39mkill()\n",
      "File \u001b[0;32m/usr/lib/python3.9/subprocess.py:1121\u001b[0m, in \u001b[0;36mPopen.communicate\u001b[0;34m(self, input, timeout)\u001b[0m\n\u001b[1;32m   1119\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_stdin_write(\u001b[38;5;28minput\u001b[39m)\n\u001b[1;32m   1120\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mstdout:\n\u001b[0;32m-> 1121\u001b[0m     stdout \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mstdout\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mread\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m   1122\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mstdout\u001b[38;5;241m.\u001b[39mclose()\n\u001b[1;32m   1123\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mstderr:\n",
      "\u001b[0;31mKeyboardInterrupt\u001b[0m: "
     ]
    }
   ],
   "source": [
    "from pathlib import Path\n",
    "import subprocess\n",
    "import shlex\n",
    "\n",
    "from xsdata.formats.dataclass.parsers import XmlParser\n",
    "from pyfeyn2.render.latex.feynmp import FeynmpRender\n",
    "from pyfeyn2.render.latex.tikzfeynman import TikzFeynmanRender\n",
    "from pyfeyn2.render.pyx.pyxrender import PyxRender\n",
    "from pyfeyn2.feynmandiagram import FeynML\n",
    "\n",
    "from pyfeyn2.auto.bend import auto_bend\n",
    "from pyfeyn2.auto.label import auto_label\n",
    "from pyfeyn2.auto.position import feynman_adjust_points\n",
    "\n",
    "subprocess.call(shlex.split(f'qgraf {dat}'))\n",
    "xml_string = Path(output).read_text()\n",
    "parser = XmlParser()\n",
    "fml = parser.from_string(xml_string, FeynML)\n",
    "\n",
    "def filter_diag(d):\n",
    "    count = 0\n",
    "    ecount = 0\n",
    "    for p in d.propagators:\n",
    "        if p.pdgid == 22:\n",
    "            count +=1\n",
    "        if p.pdgid == 11:\n",
    "            ecount +=1\n",
    "    if count ==1 and ecount >=2:\n",
    "        return True\n",
    "    return False\n",
    "\n",
    "ccount=0 \n",
    "for d in fml.diagrams:\n",
    "    if filter_diag(d):\n",
    "        ccount +=1\n",
    "print(\"single photon diags\", ccount)\n",
    "\n",
    "for d in fml.diagrams:\n",
    "    if filter_diag(d):\n",
    "        ccount +=1\n",
    "        d.legs[0].set_xy(-2,0)\n",
    "        d.legs[1].set_xy(2,0)\n",
    "        d = feynman_adjust_points(d,size=15)\n",
    "        auto_bend(d)\n",
    "        auto_label(d.propagators)\n",
    "        auto_label(d.legs)\n",
    "        #print(d)\n",
    "        t = TikzFeynmanRender(d)\n",
    "        #print(t.get_src())\n",
    "        t.render(show=True)\n",
    "        #break"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ab4399ea",
   "metadata": {},
   "outputs": [],
   "source": [
    "print(xml_string)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6cb264a7",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.16"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
