<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pylatex.utils &mdash; pyfeyn2  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/jupyter-sphinx.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/thebelab.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="../../_static/thebelab-helper.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> pyfeyn2
            <img src="../../_static/pyfeyn-logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2.2.3-1-gde23f1e8
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">FeynML:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../feynml/index.html">FeynML</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Gallery:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../gallery/index.html">Gallery</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Renderers:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../renderers/index.html">Renderers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Interfaces:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../interfaces/index.html">Interfaces</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../_autosummary/pyfeyn2.html">pyfeyn2</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Versions:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://pyfeyn2.readthedocs.io/en/stable/">RTD</a></li>
<li class="toctree-l1"><a class="reference external" href="https://apn-pucky.github.io/pyfeyn2/">Stable</a></li>
<li class="toctree-l1"><a class="reference external" href="https://apn-pucky.github.io/pyfeyn2/test/">Dev</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/APN-Pucky/pyfeyn2">GitHub</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pyfeyn2</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">pylatex.utils</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for pylatex.utils</h1><div class="highlight"><pre>
<span></span># -*- coding: utf-8 -*-
&quot;&quot;&quot;
This module implements some simple utility functions.

..  :copyright: (c) 2014 by Jelte Fennema.
    :license: MIT, see License for more details.
&quot;&quot;&quot;

import os.path
import shutil
import tempfile
import pylatex.base_classes

_latex_special_chars = {
    &#39;&amp;&#39;: r&#39;\&amp;&#39;,
    &#39;%&#39;: r&#39;\%&#39;,
    &#39;$&#39;: r&#39;\$&#39;,
    &#39;#&#39;: r&#39;\#&#39;,
    &#39;_&#39;: r&#39;\_&#39;,
    &#39;{&#39;: r&#39;\{&#39;,
    &#39;}&#39;: r&#39;\}&#39;,
    &#39;~&#39;: r&#39;\textasciitilde{}&#39;,
    &#39;^&#39;: r&#39;\^{}&#39;,
    &#39;\\&#39;: r&#39;\textbackslash{}&#39;,
    &#39;\n&#39;: &#39;\\newline%\n&#39;,
    &#39;-&#39;: r&#39;{-}&#39;,
    &#39;\xA0&#39;: &#39;~&#39;,  # Non-breaking space
    &#39;[&#39;: r&#39;{[}&#39;,
    &#39;]&#39;: r&#39;{]}&#39;,
}

_tmp_path = None


def _is_iterable(element):
    return hasattr(element, &#39;__iter__&#39;) and not isinstance(element, str)


<div class="viewcode-block" id="NoEscape"><a class="viewcode-back" href="../../_autosummary/pyfeyn2.render.latex.tikzfeynman.NoEscape.html#pyfeyn2.render.all.NoEscape">[docs]</a>class NoEscape(str):
    &quot;&quot;&quot;
    A simple string class that is not escaped.

    When a `.NoEscape` string is added to another `.NoEscape` string it will
    produce a `.NoEscape` string. If it is added to normal string it will
    produce a normal string.

    Args
    ----
    string: str
        The content of the `NoEscape` string.
    &quot;&quot;&quot;

    def __repr__(self):
        return &#39;%s(%s)&#39; % (self.__class__.__name__, self)

    def __add__(self, right):
        s = super().__add__(right)
        if isinstance(right, NoEscape):
            return NoEscape(s)
        return s</div>


def escape_latex(s):
    r&quot;&quot;&quot;Escape characters that are special in latex.

    Args
    ----
    s : `str`, `NoEscape` or anything that can be converted to string
        The string to be escaped. If this is not a string, it will be converted
        to a string using `str`. If it is a `NoEscape` string, it will pass
        through unchanged.

    Returns
    -------
    NoEscape
        The string, with special characters in latex escaped.

    Examples
    --------
    &gt;&gt;&gt; escape_latex(&quot;Total cost: $30,000&quot;)
    &#39;Total cost: \$30,000&#39;
    &gt;&gt;&gt; escape_latex(&quot;Issue #5 occurs in 30% of all cases&quot;)
    &#39;Issue \#5 occurs in 30\% of all cases&#39;
    &gt;&gt;&gt; print(escape_latex(&quot;Total cost: $30,000&quot;))

    References
    ----------
        * http://tex.stackexchange.com/a/34586/43228
        * http://stackoverflow.com/a/16264094/2570866
    &quot;&quot;&quot;

    if isinstance(s, NoEscape):
        return s

    return NoEscape(&#39;&#39;.join(_latex_special_chars.get(c, c) for c in str(s)))


def fix_filename(path):
    r&quot;&quot;&quot;Fix filenames for use in LaTeX.

    Latex has problems if there are one or more points in the filename, thus
    &#39;abc.def.jpg&#39; will be changed to &#39;{abc.def}.jpg&#39;

    Windows gets angry about the curly braces that resolve the above issue on
    linux Latex distributions. MikTeX however, has no qualms about multiple
    dots in the filename so the behavior is different for posix vs nt when the
    length of file_parts is greater than two.

    Args
    ----
    filename : str
        The file name to be changed.

    Returns
    -------
    str
        The new filename.

    Examples
    --------
    &gt;&gt;&gt; fix_filename(&quot;foo.bar.pdf&quot;)
    &#39;{foo.bar}.pdf&#39;
    &gt;&gt;&gt; fix_filename(&quot;/etc/local/foo.bar.pdf&quot;)
    &#39;/etc/local/{foo.bar}.pdf&#39;
    &gt;&gt;&gt; fix_filename(&quot;/etc/local/foo.bar.baz/document.pdf&quot;)
    &#39;/etc/local/foo.bar.baz/document.pdf&#39;
    &gt;&gt;&gt; fix_filename(&quot;/etc/local/foo.bar.baz/foo~1/document.pdf&quot;)
    &#39;\detokenize{/etc/local/foo.bar.baz/foo~1/document.pdf}&#39;
    &quot;&quot;&quot;

    path_parts = path.split(&#39;/&#39; if os.name == &#39;posix&#39; else &#39;\\&#39;)
    dir_parts = path_parts[:-1]

    filename = path_parts[-1]
    file_parts = filename.split(&#39;.&#39;)

    if os.name == &#39;posix&#39; and len(file_parts) &gt; 2:
        filename = &#39;{&#39; + &#39;.&#39;.join(file_parts[0:-1]) + &#39;}.&#39; + file_parts[-1]

    dir_parts.append(filename)
    fixed_path = &#39;/&#39;.join(dir_parts)

    if &#39;~&#39; in fixed_path:
        fixed_path = r&#39;\detokenize{&#39; + fixed_path + &#39;}&#39;

    return fixed_path


def dumps_list(l, *, escape=True, token=&#39;%\n&#39;, mapper=None, as_content=True):
    r&quot;&quot;&quot;Try to generate a LaTeX string of a list that can contain anything.

    Args
    ----
    l : list
        A list of objects to be converted into a single string.
    escape : bool
        Whether to escape special LaTeX characters in converted text.
    token : str
        The token (default is a newline) to separate objects in the list.
    mapper: callable or `list`
        A function, class or a list of functions/classes that should be called
        on all entries of the list after converting them to a string, for
        instance `~.bold` or `~.MediumText`.
    as_content: bool
        Indicates whether the items in the list should be dumped using
        `~.LatexObject.dumps_as_content`

    Returns
    -------
    NoEscape
        A single LaTeX string.

    Examples
    --------
    &gt;&gt;&gt; dumps_list([r&quot;\textbf{Test}&quot;, r&quot;\nth{4}&quot;])
    &#39;\\textbf{Test}%\n\\nth{4}&#39;
    &gt;&gt;&gt; print(dumps_list([r&quot;\textbf{Test}&quot;, r&quot;\nth{4}&quot;]))
    \textbf{Test}
    \nth{4}
    &gt;&gt;&gt; print(pylatex.utils.dumps_list([&quot;There are&quot;, 4, &quot;lights!&quot;]))
    There are
    4
    lights!
    &gt;&gt;&gt; print(dumps_list([&quot;$100%&quot;, &quot;True&quot;], escape=True))
    \$100\%
    True
    &quot;&quot;&quot;
    strings = (_latex_item_to_string(i, escape=escape, as_content=as_content)
               for i in l)

    if mapper is not None:
        if not isinstance(mapper, list):
            mapper = [mapper]

        for m in mapper:
            strings = [m(s) for s in strings]
        strings = [_latex_item_to_string(s) for s in strings]

    return NoEscape(token.join(strings))


def _latex_item_to_string(item, *, escape=False, as_content=False):
    &quot;&quot;&quot;Use the render method when possible, otherwise uses str.

    Args
    ----
    item: object
        An object that needs to be converted to a string
    escape: bool
        Flag that indicates if escaping is needed
    as_content: bool
        Indicates whether the item should be dumped using
        `~.LatexObject.dumps_as_content`

    Returns
    -------
    NoEscape
        Latex
    &quot;&quot;&quot;

    if isinstance(item, pylatex.base_classes.LatexObject):
        if as_content:
            return item.dumps_as_content()
        else:
            return item.dumps()
    elif not isinstance(item, str):
        item = str(item)

    if escape:
        item = escape_latex(item)

    return item


def bold(s, *, escape=True):
    r&quot;&quot;&quot;Make a string appear bold in LaTeX formatting.

    bold() wraps a given string in the LaTeX command \textbf{}.

    Args
    ----
    s : str
        The string to be formatted.
    escape: bool
        If true the bold text will be escaped

    Returns
    -------
    NoEscape
        The formatted string.

    Examples
    --------
    &gt;&gt;&gt; bold(&quot;hello&quot;)
    &#39;\\textbf{hello}&#39;
    &gt;&gt;&gt; print(bold(&quot;hello&quot;))
    \textbf{hello}
    &quot;&quot;&quot;

    if escape:
        s = escape_latex(s)

    return NoEscape(r&#39;\textbf{&#39; + s + &#39;}&#39;)


def italic(s, *, escape=True):
    r&quot;&quot;&quot;Make a string appear italicized in LaTeX formatting.

    italic() wraps a given string in the LaTeX command \textit{}.

    Args
    ----
    s : str
        The string to be formatted.
    escape: bool
        If true the italic text will be escaped

    Returns
    -------
    NoEscape
        The formatted string.

    Examples
    --------
    &gt;&gt;&gt; italic(&quot;hello&quot;)
    &#39;\\textit{hello}&#39;
    &gt;&gt;&gt; print(italic(&quot;hello&quot;))
    \textit{hello}
    &quot;&quot;&quot;
    if escape:
        s = escape_latex(s)

    return NoEscape(r&#39;\textit{&#39; + s + &#39;}&#39;)


def verbatim(s, *, delimiter=&#39;|&#39;):
    r&quot;&quot;&quot;Make the string verbatim.

    Wraps the given string in a \verb LaTeX command.

    Args
    ----
    s : str
        The string to be formatted.
    delimiter : str
        How to designate the verbatim text (default is a pipe | )

    Returns
    -------
    NoEscape
        The formatted string.

    Examples
    --------
    &gt;&gt;&gt; verbatim(r&quot;\renewcommand{}&quot;)
    &#39;\\verb|\\renewcommand{}|&#39;
    &gt;&gt;&gt; print(verbatim(r&quot;\renewcommand{}&quot;))
    \verb|\renewcommand{}|
    &gt;&gt;&gt; print(verbatim(&#39;pi|pe&#39;, &#39;!&#39;))
    \verb!pi|pe!
    &quot;&quot;&quot;

    return NoEscape(r&#39;\verb&#39; + delimiter + s + delimiter)


def make_temp_dir():
    &quot;&quot;&quot;Create a temporary directory if it doesn&#39;t exist.

    Returns
    -------
    str
        The absolute filepath to the created temporary directory.

    Examples
    --------
    &gt;&gt;&gt; make_temp_dir()
    &#39;/var/folders/g9/ct5f3_r52c37rbls5_9nc_qc0000gn/T/pylatex&#39;
    &quot;&quot;&quot;

    global _tmp_path
    if not _tmp_path:
        _tmp_path = tempfile.mkdtemp(prefix=&quot;pylatex-tmp.&quot;)
    return _tmp_path


def rm_temp_dir():
    &quot;&quot;&quot;Remove the temporary directory specified in ``_tmp_path``.&quot;&quot;&quot;

    global _tmp_path
    if _tmp_path:
        shutil.rmtree(_tmp_path)
        _tmp_path = None
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Alexander Puck Neuwirth.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>