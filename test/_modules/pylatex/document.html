<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pylatex.document &mdash; pyfeyn2  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/jupyter-sphinx.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/thebelab.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="../../_static/thebelab-helper.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> pyfeyn2
            <img src="../../_static/pyfeyn-logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2.2.3-1-gde23f1e8
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">FeynML:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../feynml/index.html">FeynML</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Gallery:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../gallery/index.html">Gallery</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Renderers:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../renderers/index.html">Renderers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Interfaces:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../interfaces/index.html">Interfaces</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../_autosummary/pyfeyn2.html">pyfeyn2</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Versions:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://pyfeyn2.readthedocs.io/en/stable/">RTD</a></li>
<li class="toctree-l1"><a class="reference external" href="https://apn-pucky.github.io/pyfeyn2/">Stable</a></li>
<li class="toctree-l1"><a class="reference external" href="https://apn-pucky.github.io/pyfeyn2/test/">Dev</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/APN-Pucky/pyfeyn2">GitHub</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pyfeyn2</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">pylatex.document</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for pylatex.document</h1><div class="highlight"><pre>
<span></span># -*- coding: utf-8 -*-
&quot;&quot;&quot;
This module implements the class that deals with the full document.

..  :copyright: (c) 2014 by Jelte Fennema.
    :license: MIT, see License for more details.
&quot;&quot;&quot;

import os
import sys
import subprocess
import errno
from .base_classes import Environment, Command, Container, LatexObject, \
    UnsafeCommand, SpecialArguments
from .package import Package
from .errors import CompilerError
from .utils import dumps_list, rm_temp_dir, NoEscape
import pylatex.config as cf


<div class="viewcode-block" id="Document"><a class="viewcode-back" href="../../_autosummary/pyfeyn2.render.latex.latex.Document.html#pyfeyn2.render.latex.latex.Document">[docs]</a>class Document(Environment):
    r&quot;&quot;&quot;
    A class that contains a full LaTeX document.

    If needed, you can append stuff to the preamble or the packages.
    For instance, if you need to use ``\maketitle`` you can add the title,
    author and date commands to the preamble to make it work.

    &quot;&quot;&quot;

<div class="viewcode-block" id="Document.__init__"><a class="viewcode-back" href="../../_autosummary/pyfeyn2.render.latex.latex.Document.html#pyfeyn2.render.latex.latex.Document.__init__">[docs]</a>    def __init__(self, default_filepath=&#39;default_filepath&#39;, *,
                 documentclass=&#39;article&#39;, document_options=None, fontenc=&#39;T1&#39;,
                 inputenc=&#39;utf8&#39;, font_size=&quot;normalsize&quot;, lmodern=True,
                 textcomp=True, microtype=None, page_numbers=True, indent=None,
                 geometry_options=None, data=None):
        r&quot;&quot;&quot;
        Args
        ----
        default_filepath: str
            The default path to save files.
        documentclass: str or `~.Command`
            The LaTeX class of the document.
        document_options: str or `list`
            The options to supply to the documentclass
        fontenc: str
            The option for the fontenc package. If it is `None`, the fontenc
            package will not be loaded at all.
        inputenc: str
            The option for the inputenc package. If it is `None`, the inputenc
            package will not be loaded at all.
        font_size: str
            The font size to declare as normalsize
        lmodern: bool
            Use the Latin Modern font. This is a font that contains more glyphs
            than the standard LaTeX font.
        textcomp: bool
            Adds even more glyphs, for instance the Euro (â‚¬) sign.
        page_numbers: bool
            Adds the ability to add the last page to the document.
        indent: bool
            Determines whether or not the document requires indentation. If it
            is `None` it will use the value from the active config. Which is
            `True` by default.
        geometry_options: dict
            The options to supply to the geometry package
        data: list
            Initial content of the document.
        &quot;&quot;&quot;

        self.default_filepath = default_filepath

        if isinstance(documentclass, Command):
            self.documentclass = documentclass
        else:
            self.documentclass = Command(&#39;documentclass&#39;,
                                         arguments=documentclass,
                                         options=document_options)
        if indent is None:
            indent = cf.active.indent
        if microtype is None:
            microtype = cf.active.microtype

        # These variables are used by the __repr__ method
        self._fontenc = fontenc
        self._inputenc = inputenc
        self._lmodern = lmodern
        self._indent = indent
        self._microtype = microtype

        packages = []

        if fontenc is not None:
            packages.append(Package(&#39;fontenc&#39;, options=fontenc))
        if inputenc is not None:
            packages.append(Package(&#39;inputenc&#39;, options=inputenc))
        if lmodern:
            packages.append(Package(&#39;lmodern&#39;))
        if textcomp:
            packages.append(Package(&#39;textcomp&#39;))
        if page_numbers:
            packages.append(Package(&#39;lastpage&#39;))
        if not indent:
            packages.append(Package(&#39;parskip&#39;))
        if microtype:
            packages.append(Package(&#39;microtype&#39;))

        if geometry_options is not None:
            packages.append(Package(&#39;geometry&#39;))
            # Make sure we don&#39;t add this options command for an empty list,
            # because that breaks.
            if geometry_options:
                packages.append(Command(
                    &#39;geometry&#39;,
                    arguments=SpecialArguments(geometry_options),
                ))

        super().__init__(data=data)

        # Usually the name is the class name, but if we create our own
        # document class, \begin{document} gets messed up.
        self._latex_name = &#39;document&#39;

        self.packages |= packages
        self.variables = []

        self.preamble = []

        if not page_numbers:
            self.change_document_style(&quot;empty&quot;)

        # No colors have been added to the document yet
        self.color = False
        self.meta_data = False

        self.append(Command(command=font_size))</div>

    def _propagate_packages(self):
        r&quot;&quot;&quot;Propogate packages.

        Make sure that all the packages included in the previous containers
        are part of the full list of packages.
        &quot;&quot;&quot;

        super()._propagate_packages()

        for item in (self.preamble):
            if isinstance(item, LatexObject):
                if isinstance(item, Container):
                    item._propagate_packages()
                for p in item.packages:
                    self.packages.add(p)

<div class="viewcode-block" id="Document.dumps"><a class="viewcode-back" href="../../_autosummary/pyfeyn2.render.latex.latex.Document.html#pyfeyn2.render.latex.latex.Document.dumps">[docs]</a>    def dumps(self):
        &quot;&quot;&quot;Represent the document as a string in LaTeX syntax.

        Returns
        -------
        str
        &quot;&quot;&quot;

        head = self.documentclass.dumps() + &#39;%\n&#39;
        head += self.dumps_packages() + &#39;%\n&#39;
        head += dumps_list(self.variables) + &#39;%\n&#39;
        head += dumps_list(self.preamble) + &#39;%\n&#39;

        return head + &#39;%\n&#39; + super().dumps()</div>

<div class="viewcode-block" id="Document.generate_tex"><a class="viewcode-back" href="../../_autosummary/pyfeyn2.render.latex.latex.Document.html#pyfeyn2.render.latex.latex.Document.generate_tex">[docs]</a>    def generate_tex(self, filepath=None):
        &quot;&quot;&quot;Generate a .tex file for the document.

        Args
        ----
        filepath: str
            The name of the file (without .tex), if this is not supplied the
            default filepath attribute is used as the path.
        &quot;&quot;&quot;

        super().generate_tex(self._select_filepath(filepath))</div>

<div class="viewcode-block" id="Document.generate_pdf"><a class="viewcode-back" href="../../_autosummary/pyfeyn2.render.latex.latex.Document.html#pyfeyn2.render.latex.latex.Document.generate_pdf">[docs]</a>    def generate_pdf(self, filepath=None, *, clean=True, clean_tex=True,
                     compiler=None, compiler_args=None, silent=True):
        &quot;&quot;&quot;Generate a pdf file from the document.

        Args
        ----
        filepath: str
            The name of the file (without .pdf), if it is `None` the
            ``default_filepath`` attribute will be used.
        clean: bool
            Whether non-pdf files created that are created during compilation
            should be removed.
        clean_tex: bool
            Also remove the generated tex file.
        compiler: `str` or `None`
            The name of the LaTeX compiler to use. If it is None, PyLaTeX will
            choose a fitting one on its own. Starting with ``latexmk`` and then
            ``pdflatex``.
        compiler_args: `list` or `None`
            Extra arguments that should be passed to the LaTeX compiler. If
            this is None it defaults to an empty list.
        silent: bool
            Whether to hide compiler output
        &quot;&quot;&quot;

        if compiler_args is None:
            compiler_args = []

        # In case of newer python with the use of the cwd parameter
        # one can avoid to physically change the directory
        # to the destination folder
        python_cwd_available = sys.version_info &gt;= (3, 6)

        filepath = self._select_filepath(filepath)
        if not os.path.basename(filepath):
            filepath = os.path.join(os.path.abspath(filepath),
                                    &#39;default_basename&#39;)
        else:
            filepath = os.path.abspath(filepath)

        cur_dir = os.getcwd()
        dest_dir = os.path.dirname(filepath)

        if not python_cwd_available:
            os.chdir(dest_dir)

        self.generate_tex(filepath)

        if compiler is not None:
            compilers = ((compiler, []),)
        else:
            latexmk_args = [&#39;--pdf&#39;]

            compilers = (
                (&#39;latexmk&#39;, latexmk_args),
                (&#39;pdflatex&#39;, [])
            )

        main_arguments = [&#39;--interaction=nonstopmode&#39;, filepath + &#39;.tex&#39;]

        check_output_kwargs = {}
        if python_cwd_available:
            check_output_kwargs = {&#39;cwd&#39;: dest_dir}

        os_error = None

        for compiler, arguments in compilers:
            command = [compiler] + arguments + compiler_args + main_arguments

            try:
                output = subprocess.check_output(command,
                                                 stderr=subprocess.STDOUT,
                                                 **check_output_kwargs)
            except (OSError, IOError) as e:
                # Use FileNotFoundError when python 2 is dropped
                os_error = e

                if os_error.errno == errno.ENOENT:
                    # If compiler does not exist, try next in the list
                    continue
                raise
            except subprocess.CalledProcessError as e:
                # For all other errors print the output and raise the error
                print(e.output.decode())
                raise
            else:
                if not silent:
                    print(output.decode())

            if clean:
                try:
                    # Try latexmk cleaning first
                    subprocess.check_output([&#39;latexmk&#39;, &#39;-c&#39;, filepath],
                                            stderr=subprocess.STDOUT,
                                            **check_output_kwargs)
                except (OSError, IOError, subprocess.CalledProcessError):
                    # Otherwise just remove some file extensions.
                    extensions = [&#39;aux&#39;, &#39;log&#39;, &#39;out&#39;, &#39;fls&#39;,
                                  &#39;fdb_latexmk&#39;]

                    for ext in extensions:
                        try:
                            os.remove(filepath + &#39;.&#39; + ext)
                        except (OSError, IOError) as e:
                            # Use FileNotFoundError when python 2 is dropped
                            if e.errno != errno.ENOENT:
                                raise
                rm_temp_dir()

            if clean_tex:
                os.remove(filepath + &#39;.tex&#39;)  # Remove generated tex file

            # Compilation has finished, so no further compilers have to be
            # tried
            break

        else:
            # Notify user that none of the compilers worked.
            raise(CompilerError(
                &#39;No LaTex compiler was found\n&#39;
                &#39;Either specify a LaTex compiler &#39;
                &#39;or make sure you have latexmk or pdfLaTex installed.&#39;
            ))

        if not python_cwd_available:
            os.chdir(cur_dir)</div>

    def _select_filepath(self, filepath):
        &quot;&quot;&quot;Make a choice between ``filepath`` and ``self.default_filepath``.

        Args
        ----
        filepath: str
            the filepath to be compared with ``self.default_filepath``

        Returns
        -------
        str
            The selected filepath
        &quot;&quot;&quot;

        if filepath is None:
            return self.default_filepath
        else:
            if os.path.basename(filepath) == &#39;&#39;:
                filepath = os.path.join(filepath, os.path.basename(
                    self.default_filepath))
            return filepath

<div class="viewcode-block" id="Document.change_page_style"><a class="viewcode-back" href="../../_autosummary/pyfeyn2.render.latex.latex.Document.html#pyfeyn2.render.latex.latex.Document.change_page_style">[docs]</a>    def change_page_style(self, style):
        r&quot;&quot;&quot;Alternate page styles of the current page.

        Args
        ----
        style: str
            value to set for the page style of the current page
        &quot;&quot;&quot;

        self.append(Command(&quot;thispagestyle&quot;, arguments=style))</div>

<div class="viewcode-block" id="Document.change_document_style"><a class="viewcode-back" href="../../_autosummary/pyfeyn2.render.latex.latex.Document.html#pyfeyn2.render.latex.latex.Document.change_document_style">[docs]</a>    def change_document_style(self, style):
        r&quot;&quot;&quot;Alternate page style for the entire document.

        Args
        ----
        style: str
            value to set for the document style
        &quot;&quot;&quot;

        self.append(Command(&quot;pagestyle&quot;, arguments=style))</div>

<div class="viewcode-block" id="Document.add_color"><a class="viewcode-back" href="../../_autosummary/pyfeyn2.render.latex.latex.Document.html#pyfeyn2.render.latex.latex.Document.add_color">[docs]</a>    def add_color(self, name, model, description):
        r&quot;&quot;&quot;Add a color that can be used throughout the document.

        Args
        ----
        name: str
            Name to set for the color
        model: str
            The color model to use when defining the color
        description: str
            The values to use to define the color
        &quot;&quot;&quot;

        if self.color is False:
            self.packages.append(Package(&quot;color&quot;))
            self.color = True

        self.preamble.append(Command(&quot;definecolor&quot;, arguments=[name,
                                                               model,
                                                               description]))</div>

<div class="viewcode-block" id="Document.change_length"><a class="viewcode-back" href="../../_autosummary/pyfeyn2.render.latex.latex.Document.html#pyfeyn2.render.latex.latex.Document.change_length">[docs]</a>    def change_length(self, parameter, value):
        r&quot;&quot;&quot;Change the length of a certain parameter to a certain value.

        Args
        ----
        parameter: str
            The name of the parameter to change the length for
        value: str
            The value to set the parameter to
        &quot;&quot;&quot;

        self.preamble.append(UnsafeCommand(&#39;setlength&#39;,
                                           arguments=[parameter, value]))</div>

<div class="viewcode-block" id="Document.set_variable"><a class="viewcode-back" href="../../_autosummary/pyfeyn2.render.latex.latex.Document.html#pyfeyn2.render.latex.latex.Document.set_variable">[docs]</a>    def set_variable(self, name, value):
        r&quot;&quot;&quot;Add a variable which can be used inside the document.

        Variables are defined before the preamble. If a variable with that name
        has already been set, the new value will override it for future uses.
        This is done by appending ``\renewcommand`` to the document.

        Args
        ----
        name: str
            The name to set for the variable
        value: str
            The value to set for the variable
        &quot;&quot;&quot;

        name_arg = &quot;\\&quot; + name
        variable_exists = False

        for variable in self.variables:
            if name_arg == variable.arguments._positional_args[0]:
                variable_exists = True
                break

        if variable_exists:
            renew = Command(command=&quot;renewcommand&quot;,
                            arguments=[NoEscape(name_arg), value])
            self.append(renew)
        else:
            new = Command(command=&quot;newcommand&quot;,
                          arguments=[NoEscape(name_arg), value])
            self.variables.append(new)</div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Alexander Puck Neuwirth.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>